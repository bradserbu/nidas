<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>nidas: nidas::core::DOMObjectFactory Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">nidas
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacenidas.html">nidas</a></li><li class="navelem"><a class="el" href="namespacenidas_1_1core.html">core</a></li><li class="navelem"><a class="el" href="classnidas_1_1core_1_1DOMObjectFactory.html">DOMObjectFactory</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classnidas_1_1core_1_1DOMObjectFactory-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nidas::core::DOMObjectFactory Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class that supports creating instances of <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a> objects from a string containing the class name of the object to be created.  
 <a href="classnidas_1_1core_1_1DOMObjectFactory.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DOMObjectFactory_8h_source.html">DOMObjectFactory.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6c3aebbe9425711c9c99fec4b82c1a8f"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classnidas_1_1core_1_1DOMable.html">DOMable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnidas_1_1core_1_1DOMObjectFactory.html#a6c3aebbe9425711c9c99fec4b82c1a8f">dom_object_ctor_t</a> ()</td></tr>
<tr class="memdesc:a6c3aebbe9425711c9c99fec4b82c1a8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prototype of the creator function.  <a href="#a6c3aebbe9425711c9c99fec4b82c1a8f">More...</a><br/></td></tr>
<tr class="separator:a6c3aebbe9425711c9c99fec4b82c1a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a47555fd77715fb175ccb000ec50517b8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classnidas_1_1core_1_1DOMable.html">DOMable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnidas_1_1core_1_1DOMObjectFactory.html#a47555fd77715fb175ccb000ec50517b8">createObject</a> (const std::string &amp;classname)  throw (nidas::util::Exception)</td></tr>
<tr class="memdesc:a47555fd77715fb175ccb000ec50517b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a> object given its <code>classname</code>, by looking up and executing its creator function, typically from a shared library.  <a href="#a47555fd77715fb175ccb000ec50517b8">More...</a><br/></td></tr>
<tr class="separator:a47555fd77715fb175ccb000ec50517b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:af7fabcf691b978bb9cc93b6b300b13bf"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnidas_1_1core_1_1DOMObjectFactory.html#af7fabcf691b978bb9cc93b6b300b13bf">soVersionSuffix</a> = &quot;.so.1&quot;</td></tr>
<tr class="memdesc:af7fabcf691b978bb9cc93b6b300b13bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">When searching for libraries based on the class name, add this suffix to the name.  <a href="#af7fabcf691b978bb9cc93b6b300b13bf">More...</a><br/></td></tr>
<tr class="separator:af7fabcf691b978bb9cc93b6b300b13bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class that supports creating instances of <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a> objects from a string containing the class name of the object to be created. </p>
<p>Classes can be dynamically loaded from shared libraries. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a6c3aebbe9425711c9c99fec4b82c1a8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classnidas_1_1core_1_1DOMable.html">DOMable</a>* nidas::core::DOMObjectFactory::dom_object_ctor_t()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prototype of the creator function. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a47555fd77715fb175ccb000ec50517b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnidas_1_1core_1_1DOMable.html">DOMable</a> * DOMObjectFactory::createObject </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>classname</em></td><td>)</td>
          <td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2"><a class="el" href="classnidas_1_1util_1_1Exception.html">nidas::util::Exception</a></td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a> object given its <code>classname</code>, by looking up and executing its creator function, typically from a shared library. </p>
<p>In order to be created via this method, an object's class must have the following characteristics:</p>
<ol type="1">
<li>Must be derived from class <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a></li>
<li>An extern "C" function, with prototype DOMable* create_XXXX() must exist (where XXXX is based on the class name). This function must returns a pointer to a new instance of the class. This function can be defined with the <a class="el" href="DOMable_8h.html#a2135fd96f2176e2d93966e9f9fab2eeb" title="Define a &quot;creator&quot; function, an extern &quot;C&quot; function that invokes a public no-arg constructor for a cl...">NIDAS_CREATOR_FUNCTION()</a> or <a class="el" href="DOMable_8h.html#acd78c5bbde635b5085f6234fba529f6a" title="Same as NIDAS_CREATOR_FUNCTION(CLASSNAME), but with a namespace argument, indicating a namespace unde...">NIDAS_CREATOR_FUNCTION_NS()</a> macros found in <a class="el" href="DOMable_8h.html">DOMable.h</a>.</li>
<li>The C function is called without arguments, so typically it must call a no-arg constructor for the class. If the above macros are used, a no-arg constructor must exist.</li>
</ol>
<p>If it were possible to know how C++ mangles the name of a constructor then we could dynamically lookup and execute the default constuctor directly. There isn't a standard for name mangling and I don't know of an API for determining a mangled name, so we create and lookup a C creator function using our own mangling scheme.</p>
<p>For example, if the following class exists in a shareable library, and is derived from <a class="el" href="classnidas_1_1core_1_1DOMable.html" title="Interface of an object that can be instantiated from a DOM element, via the fromDOMElement method...">DOMable</a>, with a no-arg constructor: <code>nidas::dynld::MyNameSpace::MyClass</code> there then must also be an extern "C" creator function called: <code>create_nidas_dynld_MyNamespace_MyClass</code> The C function can be defined with this macro: <code><a class="el" href="DOMable_8h.html#acd78c5bbde635b5085f6234fba529f6a" title="Same as NIDAS_CREATOR_FUNCTION(CLASSNAME), but with a namespace argument, indicating a namespace unde...">NIDAS_CREATOR_FUNCTION_NS(MyNameSpace,MyClass)</a></code> The <code>classname</code> string argument passed to this createDOMObject() method doesn't contain the leading "nidas::dynld" namespace qualifier, and can be specified in C++ style with "::" delimiters: <code>"MyNameSpace::MyClass"</code> or Java style, with "." delimiters: <code>"MyNameSpace.MyClass"</code> </p>
<p>If the class is in the <a class="el" href="namespacenidas_1_1dynld.html" title="The dynamically loadable classes of nidas. The nidas::dynld namespace and any sub namespaces...">nidas::dynld</a> namespace, the example above becomes: <code>nidas::dynld::MyClass</code> Extern "C" function: <code>create_nidas_dynld_MyClass</code> Macro to define the C function: <code><a class="el" href="DOMable_8h.html#a2135fd96f2176e2d93966e9f9fab2eeb" title="Define a &quot;creator&quot; function, an extern &quot;C&quot; function that invokes a public no-arg constructor for a cl...">NIDAS_CREATOR_FUNCTION(MyClass)</a></code> <code>classname</code> argument to this method: <code>"MyClass"</code> </p>
<p>The name of the creator function is mangled from the <code>classname</code> argument as follows. The given <code>classname</code> is converted by appending it to <code>nidas_dynld_</code>, and all occurrences of double-colons (::) and periods (.) are replaced with * underscores (_). Then <code>create_</code> is prepended to the converted class name.</p>
<p>The extern "C" function can be either statically linked in the program, or in a shareable library. <a class="el" href="classnidas_1_1core_1_1DOMObjectFactory.html#a47555fd77715fb175ccb000ec50517b8" title="Create a DOMable object given its classname, by looking up and executing its creator function...">createObject()</a> attempts to resolve the extern "C" function symbol via the following search:</p>
<ol type="1">
<li>Lookup the symbol within the program and the currently loaded dynamic libraries, by calling <a class="el" href="classnidas_1_1core_1_1DynamicLoader.html#a275d45c165d64e6261c17315a8be8517" title="Search the main program itself, and its currently loaded libraries for a symbol. ">DynamicLoader::lookup(const std::string&amp; name)</a>.</li>
<li>If that fails, look for a shared library named after the converted class name, by passing the converted name with a <code></code>.so suffix to DynamicLoader::lookup(library,name). Using the first example above, the dynamic loader would look for a library called <code>nidas_dynld_MyNameSpace_MyClass.so</code>.</li>
<li>Then look for shared libraries by successively removing trailing portions of the converted name delimited by underscores, prepending <code>lib</code> to the name, and appending <code>soVersionSuffix</code>. Using the first example the loader would search the following libraries in order:<ol type="a">
<li><code>libnidas_dynld_MyNameSpace.so.1</code> </li>
<li><code>libnidas_dynld.so.1</code> assuming that soVersionSuffix was set to ".so.1" in this class.</li>
</ol>
</li>
</ol>
<p>After being created by this method, then the attributes of the object are typically filled in from an XML DOM element via virtual <a class="el" href="classnidas_1_1core_1_1DOMable.html#a3293fef3181a20b4a21315ad3b7db6e2" title="Initialize myself from a xercesc::DOMElement. ">nidas::core::DOMable::fromDOMElement()</a> method. </p>

<p>References <a class="el" href="group__LoggerMacros.html#ga8580ef8434c78e3a864d50f63222ba6a">DLOG</a>, <a class="el" href="classnidas_1_1core_1_1DynamicLoader.html#aca9fb67084677713791eb844c40288ce">nidas::core::DynamicLoader::getInstance()</a>, <a class="el" href="classnidas_1_1core_1_1DynamicLoader.html#a275d45c165d64e6261c17315a8be8517">nidas::core::DynamicLoader::lookup()</a>, and <a class="el" href="classnidas_1_1util_1_1Exception.html#ab9aed0e81a77fc788f543ade801ae817">nidas::util::Exception::what()</a>.</p>

<p>Referenced by <a class="el" href="classnidas_1_1core_1_1IOChannel.html#a1e5e91233888cdea1683767aae19c010">nidas::core::IOChannel::createIOChannel()</a>, <a class="el" href="classnidas_1_1core_1_1VariableConverter.html#a6415cf1c165eb90bdf3bdfeaa604ba56">nidas::core::VariableConverter::createVariableConverter()</a>, <a class="el" href="classnidas_1_1core_1_1DSMServer.html#a3e7168e11faf92e85508d490d2c9b2f5">nidas::core::DSMServer::fromDOMElement()</a>, <a class="el" href="classnidas_1_1core_1_1DSMService.html#a8fed88679d09a56deb39a130dbb02177">nidas::core::DSMService::fromDOMElement()</a>, <a class="el" href="classnidas_1_1core_1_1DSMConfig.html#a93487f0e4e833293309d8fc0f2c4a092">nidas::core::DSMConfig::fromDOMElement()</a>, <a class="el" href="classnidas_1_1core_1_1Project.html#ae4c7c9b27de36fe464dd80d30d39ba7b">nidas::core::Project::fromDOMElement()</a>, <a class="el" href="classnidas_1_1core_1_1SampleIOProcessor.html#a3fb6214975308dd6d790723eacfd5d7a">nidas::core::SampleIOProcessor::fromDOMElement()</a>, and <a class="el" href="classnidas_1_1core_1_1DSMConfig.html#a03adaa8f2a5f12ce8e496f5f6a696bcc">nidas::core::DSMConfig::sensorFromDOMElement()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnidas_1_1core_1_1DOMObjectFactory_a47555fd77715fb175ccb000ec50517b8_cgraph.png" border="0" usemap="#classnidas_1_1core_1_1DOMObjectFactory_a47555fd77715fb175ccb000ec50517b8_cgraph" alt=""/></div>
<map name="classnidas_1_1core_1_1DOMObjectFactory_a47555fd77715fb175ccb000ec50517b8_cgraph" id="classnidas_1_1core_1_1DOMObjectFactory_a47555fd77715fb175ccb000ec50517b8_cgraph">
<area shape="rect" id="node2" href="classnidas_1_1core_1_1DynamicLoader.html#aca9fb67084677713791eb844c40288ce" title="Get a pointer to the singleton instance of DynamicLoader. " alt="" coords="272,5,472,46"/><area shape="rect" id="node4" href="classnidas_1_1core_1_1DynamicLoader.html#a275d45c165d64e6261c17315a8be8517" title="Search the main program itself, and its currently loaded libraries for a symbol. " alt="" coords="272,70,472,111"/><area shape="rect" id="node5" href="classnidas_1_1util_1_1Exception.html#ab9aed0e81a77fc788f543ade801ae817" title="nidas::util::Exception\l::what" alt="" coords="295,135,449,177"/><area shape="rect" id="node3" href="classnidas_1_1core_1_1DynamicLoader.html#a7259c8404e7447d673366e0be0208283" title="nidas::core::DynamicLoader\l::DynamicLoader" alt="" coords="520,5,720,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af7fabcf691b978bb9cc93b6b300b13bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * DOMObjectFactory::soVersionSuffix = &quot;.so.1&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When searching for libraries based on the class name, add this suffix to the name. </p>
<p>Typically something like ".so.1". This may need more thought. The idea is not to use just ".so", without a version number, since that typically refers to symbolic links found only in -devel packages. Would be nice for this to be set somehow by the build system. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>nidas/core/<a class="el" href="DOMObjectFactory_8h_source.html">DOMObjectFactory.h</a></li>
<li>nidas/core/<a class="el" href="DOMObjectFactory_8cc.html">DOMObjectFactory.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
